# WordCloud 시각화 로직

## 1. 개요

`WordCloud`는 텍스트 데이터에서 단어의 등장 빈도를 시각적으로 표현하는 도구입니다.  
이 보고서는 파이썬 `wordcloud` 라이브러리를 기준으로 워드클라우드가 생성되는 내부 로직과 과정을 정리합니다.

---

## 2. 전체 파이프라인

입력 텍스트 또는 빈도 사전
↓
전처리 (불용어 제거, 소문자 변환 등)
↓
단어 빈도 계산
↓
단어 크기 매핑 (빈도 기반)
↓
마스킹 이미지 또는 캔버스 생성
↓
배치 알고리즘을 통한 위치 결정
↓
색상 결정 (colormap 또는 color_func)
↓
PIL 기반 렌더링 및 출력


---

## 3. 세부 단계 설명

### 3.1 텍스트 전처리

- 입력은 문자열 또는 `{단어: 빈도}` 딕셔너리 형식 가능
- 불용어(stopwords) 제거
- 소문자 통일, 특수문자 제거 등 정제 과정 포함

### 3.2 단어 빈도 분석

- 문자열 입력 시 내부에서 `collections.Counter`를 사용해 단어별 빈도 계산
- `generate()` 또는 `generate_from_frequencies()` 메서드를 통해 처리

### 3.3 크기 결정 (폰트 사이즈 매핑)

- 가장 높은 빈도를 기준으로 상대적인 크기 결정
- 선형 또는 로그 스케일로 폰트 크기를 계산
- 예: `font_size = min_font + (max_font - min_font) * (freq / max_freq)`


### 3.4 마스킹 및 캔버스 설정

- 기본은 직사각형 캔버스 (`width`, `height`)
- `mask` 인자를 통해 특정 이미지 형태로 단어를 제한할 수 있음
- 마스크는 2D numpy array 형태여야 함
- 밝은 부분(255)은 비어 있는 공간, 어두운 부분(0)은 텍스트가 들어갈 공간

### 3.5 단어 배치 알고리즘

- 큰 단어부터 순차적으로 배치
- 충돌이 발생하지 않도록 배치 위치를 계속 변경
- 기본 배치 알고리즘은 **Spiral 방식**
- Archimedean spiral 또는 rectangular spiral
- 중심에서 바깥쪽으로 회전하면서 배치

### 3.6 색상 결정

- 단어 색상은 다음 방식 중 하나로 지정:
- `color_func`를 통한 수동 지정
- `colormap`을 통한 자동 색상 맵핑
- 마스크 이미지에서 색상 추출 (recolor with image_colors)

### 3.7 이미지 렌더링

- 단어의 위치, 크기, 색상이 결정되면 PIL 이미지 객체 위에 텍스트를 그림
- `to_image()` → PIL 객체 반환
- `to_file("filename.png")` → 이미지 파일 저장
- `matplotlib` 등을 이용한 시각화도 가능

---

## 4. 재현성 관련 요소

- WordCloud는 실행할 때마다 배치 결과가 달라질 수 있음 (랜덤 요소 포함)
- 동일한 결과를 원할 경우 `random_state` 설정 필요
`WordCloud(random_state=42)`

